{"ast":null,"code":"import { FormGroup, Validators } from '@angular/forms';\nimport { ApiUrl } from 'src/app/core/apiUrl';\nimport { Patterns } from 'src/app/shared/models/patterns.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"src/app/services/message/message.service\";\nimport * as i4 from \"src/app/services/http/http.service\";\nimport * as i5 from \"src/app/core/utils.service\";\nimport * as i6 from \"@porsche-design-system/components-angular\";\nimport * as i7 from \"@ngx-translate/core\";\nexport let AddDealerComponent = /*#__PURE__*/(() => {\n  class AddDealerComponent {\n    constructor(formBuilder, route, router, message, http, UtilsService) {\n      this.formBuilder = formBuilder;\n      this.route = route;\n      this.router = router;\n      this.message = message;\n      this.http = http;\n      this.UtilsService = UtilsService;\n      this.dealerForm = new FormGroup({});\n      this.isSubmitted = false;\n      this.isLoading = false;\n      this.validationPattern = new Patterns();\n      this.createdealerForm();\n    }\n    ngOnInit() {\n      this.staffId = this.route.snapshot.paramMap.get('staffId');\n      this.dealerId = this.route.snapshot.paramMap.get('id');\n      if (this.dealerId) {\n        this.getDealerDetails();\n      }\n      const inputElement = document.getElementById('phoneNumberInput');\n      inputElement.addEventListener('keydown', event => {\n        // Allow key codes for digits and necessary control keys (e.g., backspace, delete, arrow keys)\n        const allowedKeyCodes = [8, 9, 37, 39, 46]; // Backspace, Tab, Left Arrow, Right Arrow, Delete\n        if (!allowedKeyCodes.includes(event.keyCode) && (event.key < '0' || event.key > '9')) {\n          event.preventDefault();\n        }\n      });\n    }\n    /*** Intialize Dealer Form ***/\n    createdealerForm() {\n      this.dealerForm = this.formBuilder.group({\n        name: ['', [Validators.required]],\n        email: ['', [Validators.required, Validators.pattern(this.validationPattern.emailPattern)]],\n        contactNumber: ['', [Validators.required, Validators.pattern(this.validationPattern.telPattern)]]\n      });\n    }\n    /*** Get Dealer Details ***/\n    getDealerDetails() {\n      this.isLoading = true;\n      const url = ApiUrl.admin.center + '/' + this.dealerId;\n      this.http.getData(url).subscribe(response => {\n        this.isLoading = false;\n        if (!!response) {\n          const result = response.result ? response.result : null;\n          if (result) {\n            this.setFormData(result);\n          } else {\n            this.message.toast('error', response.message);\n            this.router.navigate(['/admin']);\n          }\n        }\n      }, err => {\n        this.router.navigate(['/admin']);\n      });\n    }\n    /*** Set Default Values ***/\n    setFormData(data) {\n      this.dealerForm.controls.name.patchValue(data.name);\n      this.dealerForm.controls.email.patchValue(data.email);\n      //  this.dealerForm.controls.contactNumber.patchValue(data.contactNumber);\n      this.dealerForm.controls.contactNumber.patchValue(data.contactNumber.includes('+1') ? +data.contactNumber.slice(2).replace(/\\D/g, '') : data.contactNumber.replace(/\\D/g, ''));\n      this.formatPhoneNumber();\n    }\n    /*** Trim form values ***/\n    trim(key) {\n      this.dealerForm.controls[key].patchValue(this.dealerForm.controls[key].value.trim());\n    }\n    /*** Submit Login Form ***/\n    onSubmit() {\n      this.isSubmitted = true;\n      if (!this.dealerForm.valid) {\n        setTimeout(() => {\n          this.isSubmitted = false;\n        }, 10000);\n        return;\n      }\n      const params = Object.assign({}, this.dealerForm.value);\n      params.contactNumber = params.contactNumber.toString();\n      params.contactNumber = !params.contactNumber.includes('+1') ? '+1 ' + params.contactNumber : params.contactNumber;\n      this.isLoading = true;\n      if (this.dealerId) {\n        params.id = +this.dealerId;\n        this.http.putData(ApiUrl.admin.center, params).subscribe(response => {\n          this.isLoading = false;\n          if (!!response) {\n            this.message.toast('success', response.message);\n            if (this.staffId) {\n              this.router.navigate(['admin/all-staff', this.dealerId]);\n            } else {\n              this.router.navigate(['admin/all-dealers']);\n            }\n          }\n        }, err => {\n          this.isLoading = false;\n        });\n      } else {\n        this.http.postData(ApiUrl.admin.center, params).subscribe(response => {\n          this.isLoading = false;\n          if (!!response) {\n            this.message.toast('success', response.message);\n            this.router.navigate(['admin/all-dealers']);\n          }\n        }, err => {\n          this.isLoading = false;\n        });\n      }\n    }\n    /*** Navigate Back to Listing***/\n    backToListing() {\n      if (this.staffId) {\n        this.router.navigate(['admin/all-staff', this.dealerId]);\n      } else {\n        this.router.navigate(['admin/all-dealers']);\n      }\n    }\n    formatPhoneNumber() {\n      const input = document.getElementById(\"phoneNumberInput\");\n      input.value = this.UtilsService.formatPhoneNumber(input.value);\n      this.dealerForm.patchValue({\n        contactNumber: input.value\n      });\n      /*  if (this.dealerForm.controls.contactNumber.valid)\r\n         input.value = input.value ? this.UtilsService.formatPhoneNumber(input.value) : ''; */\n    }\n  }\n\n  AddDealerComponent.ɵfac = function AddDealerComponent_Factory(t) {\n    return new (t || AddDealerComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.MessageService), i0.ɵɵdirectiveInject(i4.HttpService), i0.ɵɵdirectiveInject(i5.UtilsService));\n  };\n  AddDealerComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AddDealerComponent,\n    selectors: [[\"app-add-dealer\"]],\n    decls: 58,\n    vars: 61,\n    consts: [[1, \"add-dealer\"], [\"width\", \"extended\", 1, \"hydrated\", \"p-content-wrapper\"], [3, \"size\"], [1, \"dealer-content\"], [\"href\", \"javascript:void(0);\", 1, \"back-btn\", 3, \"click\"], [\"src\", \"assets/images/arrow-left.svg\", \"alt\", \"arrow\"], [1, \"dealer-header\"], [\"novalidate\", \"novalidate\", 1, \"dealer-form\", 3, \"formGroup\", \"ngSubmit\"], [1, \"form-grid-item-container\", \"p-flex\", \"hydrated\"], [1, \"form-grid-item\", \"p-flex__item\", \"p-flex__item--width-full\", \"hydrated\", 3, \"width\"], [1, \"hydrated\", 3, \"message\", \"state\"], [\"slot\", \"label\"], [\"type\", \"text\", \"name\", \"name\", \"formControlName\", \"name\", \"required\", \"\", 3, \"blur\", \"keyup\"], [1, \"form-grid-item\", \"form-row-spacing\", \"p-flex__item\", \"p-flex__item--width-full\", \"hydrated\", 3, \"width\"], [\"type\", \"email\", \"name\", \"email\", \"formControlName\", \"email\", \"required\", \"\", 3, \"keyup\", \"blur\"], [\"slot\", \"label\", 1, \"label-line\"], [1, \"form-grid-item-container\", \"p-flex\", \"hydrated\", \"contact-input\"], [1, \"input-number\"], [\"type\", \"tel\", \"id\", \"phoneNumberInput\", \"name\", \"contactNumber\", \"formControlName\", \"contactNumber\", \"required\", \"\", \"maxlength\", \"20\", 3, \"keyup\", \"blur\"], [1, \"btn-box\"], [\"type\", \"button\", 3, \"icon\", \"variant\", \"click\"], [\"type\", \"submit\"]],\n    template: function AddDealerComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"section\", 0)(1, \"p-content-wrapper\", 1)(2, \"p-grid\")(3, \"p-grid-item\", 2)(4, \"div\", 3)(5, \"a\", 4);\n        i0.ɵɵlistener(\"click\", function AddDealerComponent_Template_a_click_5_listener() {\n          return ctx.backToListing();\n        });\n        i0.ɵɵelement(6, \"img\", 5);\n        i0.ɵɵtext(7);\n        i0.ɵɵpipe(8, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"div\", 6)(10, \"h2\");\n        i0.ɵɵtext(11);\n        i0.ɵɵpipe(12, \"translate\");\n        i0.ɵɵpipe(13, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"p\");\n        i0.ɵɵtext(15);\n        i0.ɵɵpipe(16, \"translate\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(17, \"form\", 7);\n        i0.ɵɵlistener(\"ngSubmit\", function AddDealerComponent_Template_form_ngSubmit_17_listener() {\n          return ctx.onSubmit();\n        });\n        i0.ɵɵelementStart(18, \"p-flex\", 8)(19, \"p-flex-item\", 9)(20, \"p-text-field-wrapper\", 10);\n        i0.ɵɵpipe(21, \"translate\");\n        i0.ɵɵelementStart(22, \"span\", 11);\n        i0.ɵɵtext(23);\n        i0.ɵɵpipe(24, \"translate\");\n        i0.ɵɵpipe(25, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"input\", 12);\n        i0.ɵɵlistener(\"blur\", function AddDealerComponent_Template_input_blur_26_listener() {\n          return ctx.trim(\"name\");\n        })(\"keyup\", function AddDealerComponent_Template_input_keyup_26_listener($event) {\n          return $event.keyCode === 13 && ctx.onSubmit();\n        });\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(27, \"p-flex\", 8)(28, \"p-flex-item\", 13)(29, \"p-text-field-wrapper\", 10);\n        i0.ɵɵpipe(30, \"translate\");\n        i0.ɵɵpipe(31, \"translate\");\n        i0.ɵɵelementStart(32, \"span\", 11);\n        i0.ɵɵtext(33);\n        i0.ɵɵpipe(34, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(35, \"input\", 14);\n        i0.ɵɵlistener(\"keyup\", function AddDealerComponent_Template_input_keyup_35_listener($event) {\n          return $event.keyCode === 13 && ctx.onSubmit();\n        })(\"blur\", function AddDealerComponent_Template_input_blur_35_listener() {\n          return ctx.trim(\"email\");\n        });\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(36, \"span\", 15);\n        i0.ɵɵtext(37);\n        i0.ɵɵpipe(38, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(39, \"p-flex\", 16)(40, \"p-flex-item\", 13)(41, \"p-text-field-wrapper\", 10);\n        i0.ɵɵpipe(42, \"translate\");\n        i0.ɵɵpipe(43, \"translate\");\n        i0.ɵɵelementStart(44, \"span\", 11);\n        i0.ɵɵtext(45);\n        i0.ɵɵpipe(46, \"translate\");\n        i0.ɵɵpipe(47, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(48, \"span\", 17);\n        i0.ɵɵtext(49, \" + 91 \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(50, \"input\", 18);\n        i0.ɵɵlistener(\"keyup\", function AddDealerComponent_Template_input_keyup_50_listener($event) {\n          return $event.keyCode === 13 && ctx.onSubmit();\n        })(\"blur\", function AddDealerComponent_Template_input_blur_50_listener() {\n          return ctx.formatPhoneNumber();\n        });\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(51, \"div\", 19)(52, \"p-button\", 20);\n        i0.ɵɵlistener(\"click\", function AddDealerComponent_Template_p_button_click_52_listener() {\n          return ctx.backToListing();\n        });\n        i0.ɵɵtext(53);\n        i0.ɵɵpipe(54, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(55, \"p-button\", 21);\n        i0.ɵɵtext(56);\n        i0.ɵɵpipe(57, \"translate\");\n        i0.ɵɵelementEnd()()()()()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"size\", 12);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(8, 27, \"Back\"), \"\");\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate2(\"\", i0.ɵɵpipeBind1(12, 29, ctx.dealerId ? \"Edit\" : \"Add\"), \" \", i0.ɵɵpipeBind1(13, 31, \"Porsche Centre\"), \"\");\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(16, 33, ctx.dealerId ? \"Edit Porsche Centre details in the following fields.\" : \"Please enter Porsche Centre details in the following fields.\"));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"formGroup\", ctx.dealerForm);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"width\", \"full\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"message\", ctx.isSubmitted && ctx.dealerForm.controls.name.errors ? i0.ɵɵpipeBind1(21, 35, \"Please enter name\") : \"\")(\"state\", ctx.isSubmitted && ctx.dealerForm.controls.name.errors ? \"error\" : \"none\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate2(\"\", i0.ɵɵpipeBind1(24, 37, \"Porsche Centre\"), \" \", i0.ɵɵpipeBind1(25, 39, \"Name\"), \" \");\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"width\", \"full\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"message\", ctx.isSubmitted && (ctx.dealerForm.controls.email.errors == null ? null : ctx.dealerForm.controls.email.errors.pattern) ? i0.ɵɵpipeBind1(30, 41, \"Please enter a valid email.\") : ctx.isSubmitted && (ctx.dealerForm.controls.email.errors == null ? null : ctx.dealerForm.controls.email.errors.required) ? i0.ɵɵpipeBind1(31, 43, \"Please enter email.\") : \"\")(\"state\", ctx.isSubmitted && ctx.dealerForm.controls.email.errors ? \"error\" : \"none\");\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind1(34, 45, \"Email\"), \" \");\n        i0.ɵɵadvance(2);\n        i0.ɵɵattribute(\"disabled\", ctx.dealerId);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind1(38, 47, \"Contact Number\"), \" \");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"width\", \"full\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"message\", ctx.isSubmitted && ctx.dealerForm.controls.contactNumber.errors ? (ctx.dealerForm.controls.contactNumber.errors == null ? null : ctx.dealerForm.controls.contactNumber.errors.pattern) ? i0.ɵɵpipeBind1(42, 49, \"Please enter a valid number\") : i0.ɵɵpipeBind1(43, 51, \"Please enter contact number\") : \"\")(\"state\", ctx.isSubmitted && ctx.dealerForm.controls.contactNumber.errors ? \"error\" : \"none\");\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate2(\"\", i0.ɵɵpipeBind1(46, 53, \"Porsche Centre\"), \" \", i0.ɵɵpipeBind1(47, 55, \"Name\"), \" \");\n        i0.ɵɵadvance(5);\n        i0.ɵɵattribute(\"disabled\", ctx.dealerId);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"icon\", \"close\")(\"variant\", \"tertiary\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind1(54, 57, \"Cancel\"), \" \");\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind1(57, 59, ctx.dealerId ? \"Update Porsche Centre Info\" : \"Add Porsche Centre\"), \" \");\n      }\n    },\n    directives: [i6.PContentWrapper, i6.PGrid, i6.PGridItem, i1.ɵNgNoValidate, i1.NgControlStatusGroup, i1.FormGroupDirective, i6.PFlex, i6.PFlexItem, i6.PTextFieldWrapper, i1.DefaultValueAccessor, i1.NgControlStatus, i1.FormControlName, i1.RequiredValidator, i1.MaxLengthValidator, i6.PButton],\n    pipes: [i7.TranslatePipe],\n    styles: [\".add-dealer[_ngcontent-%COMP%]{width:100%;padding-top:40px}.add-dealer[_ngcontent-%COMP%]   .dealer-content[_ngcontent-%COMP%]{width:100%;max-width:733px;margin:0 auto}.add-dealer[_ngcontent-%COMP%]   .dealer-content[_ngcontent-%COMP%]   .dealer-header[_ngcontent-%COMP%]{width:100%;margin:0 0 20px}.add-dealer[_ngcontent-%COMP%]   .dealer-content[_ngcontent-%COMP%]   .dealer-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:32px;margin:0}.add-dealer[_ngcontent-%COMP%]   .dealer-content[_ngcontent-%COMP%]   .dealer-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;margin:0}.dealer-form[_ngcontent-%COMP%]{width:100%}.dealer-form[_ngcontent-%COMP%]   .form-row-spacing[_ngcontent-%COMP%]{margin:16px 0 0}.dealer-form[_ngcontent-%COMP%]   .btn-box[_ngcontent-%COMP%]{width:100%;display:flex;margin:39px 0}.dealer-form[_ngcontent-%COMP%]   .btn-box[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:first-child{margin-right:16px}\"]\n  });\n  return AddDealerComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}