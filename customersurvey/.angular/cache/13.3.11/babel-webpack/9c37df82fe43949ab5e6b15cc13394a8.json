{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, HostListener } from '@angular/core';\nimport { ApiUrl } from 'src/app/core/apiUrl';\nimport swal from 'sweetalert2';\nimport { debounceTime, distinctUntilChanged } from 'rxjs/operators';\nimport { Subject } from 'rxjs';\nlet StaffListingComponent = class StaffListingComponent {\n  constructor(router, route, http, message, user) {\n    this.router = router;\n    this.route = route;\n    this.http = http;\n    this.message = message;\n    this.user = user;\n    this.status = false;\n    this.isLoading = false;\n    this.displayedColumns = ['name', 'designation', 'contactNumber', 'email'];\n    this.dataSource = [];\n    this.allStaffData = [];\n    this.searchStaff = '';\n    this.isFullListDisplayed = false;\n    this.pageNumber = 1;\n    this.pageSize = 20;\n    this.searchterm = new Subject();\n  }\n  onKeydownHandler(event) {\n    swal.close();\n  }\n  ngOnInit() {\n    var _a, _b;\n    this.dealerId = this.route.snapshot.paramMap.get('dealerId');\n    this.getAllStaff();\n    this.getDealerDetails();\n    this.rolePermissions = this.user.getRoleGroup();\n    this.searchterm.pipe(\n    // Time in milliseconds between key events\n    debounceTime(500)\n    // If previous query is diffent from current\n    , distinctUntilChanged()\n    // subscription for response\n    ).subscribe(term => {\n      this.dataSource = [];\n      this.pageNumber = 1;\n      this.pageSize = 20;\n      this.isFullListDisplayed = false;\n      this.getAllStaff();\n    });\n    this.rolePermissions = this.user.getRoleGroup();\n    if (((_a = this.rolePermissions) === null || _a === void 0 ? void 0 : _a.isEdit) || ((_b = this.rolePermissions) === null || _b === void 0 ? void 0 : _b.isDelete)) {\n      this.displayedColumns = ['name', 'designation', 'contactNumber', 'email', 'actions'];\n    }\n  }\n  /*** Get Centers Listing ***/\n  getAllStaff() {\n    this.isLoading = true;\n    const params = {\n      PageNumber: this.pageNumber,\n      PageSize: this.pageSize,\n      Search: this.searchStaff\n    };\n    const url = ApiUrl.admin.center + '/' + this.dealerId + '/Staff';\n    this.http.getData(url, params, true).subscribe(response => {\n      this.isLoading = false;\n      if (!!response) {\n        const result = response.result ? response.result : [];\n        result.forEach(ele => {\n          ele.actions = '';\n        });\n        this.dataSource = result;\n        this.allStaffData = result;\n      }\n    });\n  }\n  /*** On Search ***/\n  clickEvent() {\n    this.status = !this.status;\n    this.searchStaff = this.status ? this.searchStaff : '';\n    if (!this.searchStaff) {\n      this.applyFilter();\n    }\n  }\n  /*** Get Dealer Details ***/\n  getDealerDetails() {\n    const url = ApiUrl.admin.center + '/' + this.dealerId;\n    this.http.getData(url).subscribe(response => {\n      if (!!response) {\n        const result = response.result ? response.result : null;\n        this.dealerData = result;\n      }\n    });\n  }\n  /*** Edit Dealer ***/\n  editDealer(id) {\n    this.router.navigate(['admin/edit-dealer', id, 1]);\n  }\n  /*** Edit Dealer ***/\n  editStaff(id) {\n    this.router.navigate(['admin/edit-staff', this.dealerId, id]);\n  }\n  /*** Confirm Delete ***/\n  confirmDelete(id) {\n    this.message.confirm('inactivate this member').then(data => {\n      if (data.value) {\n        this.removeStaff(id);\n      }\n    });\n  }\n  /*** Remove Dealer ***/\n  removeStaff(id) {\n    const url = ApiUrl.admin.center + '/' + this.dealerId + '/Staff';\n    this.http.deleteData(url, id.toString()).subscribe(response => {\n      if (!!response) {\n        this.message.toast('success', response.message);\n        this.getAllStaff();\n      }\n    });\n  }\n  /*** On Search ***/\n  applyFilter() {\n    this.searchterm.next(this.searchStaff);\n  }\n  /*** On Scroll load data ***/\n  onScroll() {\n    if (this.pageNumber * this.pageSize <= this.dataSource.length) {\n      this.pageNumber++;\n      this.getAllStaff();\n    } else {\n      this.isFullListDisplayed = true;\n    }\n  }\n};\n__decorate([HostListener('document:keydown.escape', ['$event'])], StaffListingComponent.prototype, \"onKeydownHandler\", null);\nStaffListingComponent = __decorate([Component({\n  selector: 'app-staff-listing',\n  templateUrl: './staff-listing.component.html',\n  styleUrls: ['./staff-listing.component.scss']\n})], StaffListingComponent);\nexport { StaffListingComponent };","map":null,"metadata":{},"sourceType":"module"}