{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, HostListener } from '@angular/core';\nimport { ApiUrl } from 'src/app/core/apiUrl';\nimport swal from 'sweetalert2';\nimport { debounceTime, distinctUntilChanged } from 'rxjs/operators';\nimport { Subject } from 'rxjs';\nlet CarModelComponent = class CarModelComponent {\n  constructor(router, http, message, sanitizer, toastr, user) {\n    this.router = router;\n    this.http = http;\n    this.message = message;\n    this.sanitizer = sanitizer;\n    this.toastr = toastr;\n    this.user = user;\n    this.status = false;\n    this.isLoading = false;\n    this.displayedColumns = ['name', 'imagePath', 'description'];\n    this.dataSource = [];\n    this.searchModel = '';\n    this.isFullListDisplayed = false;\n    this.pageNumber = 1;\n    this.pageSize = 20;\n    this.searchterm = new Subject();\n    this.tableLoad = true;\n    this.fromDelete = false;\n    this.loadCompleted = false;\n    this.searchterm.pipe(\n    // Time in milliseconds between key events\n    debounceTime(500)\n    // If previous query is diffent from current\n    , distinctUntilChanged()\n    // subscription for response\n    ).subscribe(term => {\n      this.dataSource = [];\n      this.pageNumber = 1;\n      this.pageSize = 20;\n      this.isFullListDisplayed = false;\n      this.getAllCenters();\n    });\n  }\n  onKeydownHandler(event) {\n    swal.close();\n  }\n  ngOnInit() {\n    var _a, _b;\n    this.getAllCenters();\n    this.rolePermissions = this.user.getRoleGroup();\n    if (((_a = this.rolePermissions) === null || _a === void 0 ? void 0 : _a.isEdit) || ((_b = this.rolePermissions) === null || _b === void 0 ? void 0 : _b.isDelete)) {\n      this.displayedColumns = ['name', 'imagePath', 'description', 'actions'];\n    }\n  }\n  sanitizeImageUrl(imageUrl) {\n    return this.sanitizer.bypassSecurityTrustResourceUrl(imageUrl);\n  }\n  dataTableReload() {\n    this.tableLoad = false;\n    setTimeout(() => {\n      this.tableLoad = true;\n    }, 100);\n  }\n  /*** Get Centers Listing ***/\n  getAllCenters(param) {\n    this.isLoading = true;\n    const params = {\n      PageNumber: this.pageNumber,\n      PageSize: this.pageSize,\n      Search: this.searchModel\n    };\n    this.http.getData(ApiUrl.admin.masterData.carmodel, params, true).subscribe(response => {\n      this.isLoading = false;\n      if (!!response) {\n        const result = response ? response.result : [];\n        if (result.length < this.pageSize) this.loadCompleted = true;\n        result.forEach(ele => {\n          ele.actions = '';\n        });\n        if (param) {}\n        if (this.fromDelete) {\n          this.dataSource = [...result];\n          this.fromDelete = false;\n          this.dataTableReload();\n        } else {\n          this.dataSource = [...this.dataSource, ...result];\n        }\n        if (this.dataSource.length === 0) this.toastr.error(\"No results matching the search criteria!\");\n      }\n    });\n  }\n  /*** On Search ***/\n  clickEvent() {\n    this.loadCompleted = false;\n    this.status = !this.status;\n    this.searchModel = this.status ? this.searchModel : '';\n    if (!this.searchModel) {\n      this.applyFilter();\n    }\n  }\n  /*** Get Staff Details ***/\n  tabDetails(id) {\n    this.router.navigate(['/admin/master/car-model/view', id]);\n  }\n  /*** Edit Dealer ***/\n  editTab(id) {\n    this.router.navigate(['/admin/master/car-model/edit', id]);\n  }\n  /*** Remove Dealer ***/\n  removeCenter(id) {\n    this.http.deleteData(ApiUrl.admin.masterData.carmodel, id.toString()).subscribe(response => {\n      if (!!response) {\n        this.message.toast('success', response.message);\n        this.getAllCenters();\n        this.fromDelete = true;\n      }\n    });\n  }\n  /*** Confirm Delete ***/\n  confirmDelete(id) {\n    this.message.confirm('inactivate this model').then(data => {\n      if (data.value) {\n        this.removeCenter(id);\n      }\n    });\n  }\n  confirmActivate(id, isActive) {\n    this.message.confirm(isActive ? 'activate this car model' : 'inactivate this car model').then(data => {\n      if (data.value) {\n        this.activateCarModel(id, isActive);\n      }\n    });\n  }\n  activateCarModel(id, isActive) {\n    this.http.deleteRecord(ApiUrl.admin.masterData.carmodel + '/' + id + '/' + isActive).subscribe(response => {\n      if (!!response) {\n        this.message.toast('success', response.message);\n        this.fromDelete = true;\n        this.dataSource = [...[]];\n        this.getAllCenters();\n      }\n    });\n  }\n  /*** On Search ***/\n  applyFilter() {\n    this.searchterm.next(this.searchModel);\n  }\n  /*** On Scroll load data ***/\n  onScroll() {\n    if (this.pageNumber * this.pageSize <= this.dataSource.length && !this.loadCompleted) {\n      this.pageNumber++;\n      this.getAllCenters();\n    } else {\n      this.isFullListDisplayed = true;\n    }\n  }\n};\n__decorate([HostListener('document:keydown.escape', ['$event'])], CarModelComponent.prototype, \"onKeydownHandler\", null);\nCarModelComponent = __decorate([Component({\n  selector: 'app-car-model',\n  templateUrl: './car-model.component.html',\n  styleUrls: ['./car-model.component.scss']\n})], CarModelComponent);\nexport { CarModelComponent };","map":null,"metadata":{},"sourceType":"module"}