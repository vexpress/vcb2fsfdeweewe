{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { FormGroup, Validators } from '@angular/forms';\nimport { ApiUrl } from 'src/app/core/apiUrl';\nimport { Patterns } from 'src/app/shared/models/patterns.model';\nlet AddDealerComponent = class AddDealerComponent {\n  constructor(formBuilder, route, router, message, http, UtilsService) {\n    this.formBuilder = formBuilder;\n    this.route = route;\n    this.router = router;\n    this.message = message;\n    this.http = http;\n    this.UtilsService = UtilsService;\n    this.dealerForm = new FormGroup({});\n    this.isSubmitted = false;\n    this.isLoading = false;\n    this.validationPattern = new Patterns();\n    this.createdealerForm();\n  }\n  ngOnInit() {\n    this.staffId = this.route.snapshot.paramMap.get('staffId');\n    this.dealerId = this.route.snapshot.paramMap.get('id');\n    if (this.dealerId) {\n      this.getDealerDetails();\n    }\n    const inputElement = document.getElementById('phoneNumberInput');\n    inputElement.addEventListener('keydown', event => {\n      // Allow key codes for digits and necessary control keys (e.g., backspace, delete, arrow keys)\n      const allowedKeyCodes = [8, 9, 37, 39, 46]; // Backspace, Tab, Left Arrow, Right Arrow, Delete\n      if (!allowedKeyCodes.includes(event.keyCode) && (event.key < '0' || event.key > '9')) {\n        event.preventDefault();\n      }\n    });\n  }\n  /*** Intialize Dealer Form ***/\n  createdealerForm() {\n    this.dealerForm = this.formBuilder.group({\n      name: ['', [Validators.required]],\n      email: ['', [Validators.required, Validators.pattern(this.validationPattern.emailPattern)]],\n      contactNumber: ['', [Validators.required, Validators.pattern(this.validationPattern.telPattern)]]\n    });\n  }\n  /*** Get Dealer Details ***/\n  getDealerDetails() {\n    this.isLoading = true;\n    const url = ApiUrl.admin.center + '/' + this.dealerId;\n    this.http.getData(url).subscribe(response => {\n      this.isLoading = false;\n      if (!!response) {\n        const result = response.result ? response.result : null;\n        if (result) {\n          this.setFormData(result);\n        } else {\n          this.message.toast('error', response.message);\n          this.router.navigate(['/admin']);\n        }\n      }\n    }, err => {\n      this.router.navigate(['/admin']);\n    });\n  }\n  /*** Set Default Values ***/\n  setFormData(data) {\n    this.dealerForm.controls.name.patchValue(data.name);\n    this.dealerForm.controls.email.patchValue(data.email);\n    //  this.dealerForm.controls.contactNumber.patchValue(data.contactNumber);\n    this.dealerForm.controls.contactNumber.patchValue(data.contactNumber.includes('+1') ? +data.contactNumber.slice(2).replace(/\\D/g, '') : data.contactNumber.replace(/\\D/g, ''));\n    this.formatPhoneNumber();\n  }\n  /*** Trim form values ***/\n  trim(key) {\n    this.dealerForm.controls[key].patchValue(this.dealerForm.controls[key].value.trim());\n  }\n  /*** Submit Login Form ***/\n  onSubmit() {\n    this.isSubmitted = true;\n    if (!this.dealerForm.valid) {\n      setTimeout(() => {\n        this.isSubmitted = false;\n      }, 10000);\n      return;\n    }\n    const params = Object.assign({}, this.dealerForm.value);\n    params.contactNumber = params.contactNumber.toString();\n    params.contactNumber = !params.contactNumber.includes('+1') ? '+1 ' + params.contactNumber : params.contactNumber;\n    this.isLoading = true;\n    if (this.dealerId) {\n      params.id = +this.dealerId;\n      this.http.putData(ApiUrl.admin.center, params).subscribe(response => {\n        this.isLoading = false;\n        if (!!response) {\n          this.message.toast('success', response.message);\n          if (this.staffId) {\n            this.router.navigate(['admin/all-staff', this.dealerId]);\n          } else {\n            this.router.navigate(['admin/all-dealers']);\n          }\n        }\n      }, err => {\n        this.isLoading = false;\n      });\n    } else {\n      this.http.postData(ApiUrl.admin.center, params).subscribe(response => {\n        this.isLoading = false;\n        if (!!response) {\n          this.message.toast('success', response.message);\n          this.router.navigate(['admin/all-dealers']);\n        }\n      }, err => {\n        this.isLoading = false;\n      });\n    }\n  }\n  /*** Navigate Back to Listing***/\n  backToListing() {\n    if (this.staffId) {\n      this.router.navigate(['admin/all-staff', this.dealerId]);\n    } else {\n      this.router.navigate(['admin/all-dealers']);\n    }\n  }\n  formatPhoneNumber() {\n    const input = document.getElementById(\"phoneNumberInput\");\n    input.value = this.UtilsService.formatPhoneNumber(input.value);\n    this.dealerForm.patchValue({\n      contactNumber: input.value\n    });\n    /*  if (this.dealerForm.controls.contactNumber.valid)\r\n       input.value = input.value ? this.UtilsService.formatPhoneNumber(input.value) : ''; */\n  }\n};\n\nAddDealerComponent = __decorate([Component({\n  selector: 'app-add-dealer',\n  templateUrl: './add-dealer.component.html',\n  styleUrls: ['./add-dealer.component.scss']\n})], AddDealerComponent);\nexport { AddDealerComponent };","map":null,"metadata":{},"sourceType":"module"}